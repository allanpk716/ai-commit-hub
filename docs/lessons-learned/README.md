# 经验总结文档 (Lessons Learned)

本目录收录了项目开发过程中遇到的问题、解决方案和经验总结，为未来的项目提供参考。

## 📚 文档索引

### Windows 托盘图标实现

**文档**: [windows-tray-icon-implementation-guide.md](./windows-tray-icon-implementation-guide.md)

**主题**: Wails 在 Windows 平台实现系统托盘功能的完整指南

**涵盖内容**:
- 托盘图标显示异常（透明/模糊/变形）的根因分析
- 双击功能缺失的解决方案
- 退出应用无效的修复方法
- 多级回退策略的实现
- ICO 文件格式和技术细节
- 最佳实践清单和常见陷阱

**适用场景**:
- 使用 Wails 框架开发桌面应用
- 需要实现 Windows 系统托盘功能
- 遇到托盘图标显示问题

**相关提交**:
- `6d140d6` - fix(tray): 优化 Windows 托盘图标来源及回退策略
- `73f2567` - feat(systray): 实现托盘图标双击功能并修复 Windows 显示问题
- `ff8d139` - fix(app): 修复退出应用时托盘与窗口无法完全关闭的问题

---

## 📖 文档分类

### 按问题类型分类

- **🎨 UI 问题**: 图标显示、渲染、缩放等视觉问题
- **🔧 功能实现**: 双击、右键菜单、退出流程等功能
- **🐛 Bug 修复**: 逻辑错误、状态管理、生命周期问题

### 按技术领域分类

- **Windows 平台**: 托盘图标、ICO 格式、DPI 缩放
- **Go 语言**: sync.Once、atomic.Bool、goroutine
- **Wails 框架**: onBeforeClose、Events、Runtime
- **第三方库**: systray、logger

---

## 🎯 使用指南

### 何时查看这些文档？

1. **新项目启动时**:
   - 了解常见问题和解决方案
   - 避免重复踩坑

2. **遇到问题时**:
   - 搜索相关主题文档
   - 参考已有解决方案

3. **代码审查时**:
   - 检查是否符合最佳实践
   - 识别潜在陷阱

4. **知识分享时**:
   - 作为团队培训材料
   - 沉淀技术经验

### 文档结构规范

每篇经验总结文档应包含：

1. **问题背景**: 清晰描述遇到的问题
2. **根因分析**: 深入分析问题原因
3. **解决方案**: 详细说明解决步骤
4. **代码示例**: 提供可复用的代码
5. **最佳实践**: 总结应该做和不应该做的
6. **参考资料**: 列出相关链接

---

## 📝 添加新文档

### 文档命名规范

格式: `<主题>-implementation-guide.md` 或 `<主题>-fix.md`

示例:
- `windows-tray-icon-implementation-guide.md` - 实现指南
- `database-connection-pool-fix.md` - 问题修复

### 文档模板

```markdown
# <文档标题>

**文档版本**: 1.0
**创建日期**: YYYY-MM-DD
**适用框架/平台**: <技术栈>
**问题类型**: <UI/功能/性能/安全>

---

## 问题描述

### 现象
<描述用户遇到的问题>

### 根本原因
<分析问题根本原因>

---

## 解决方案

<详细说明解决步骤和代码>

---

## 最佳实践

### ✅ 应该做的
<推荐做法>

### ❌ 不应该做的
<避免做法>

---

## 参考资料

<列出相关链接>
```

---

## 🔍 快速查找

### 按关键字查找

- **图标**: ICO、PNG、缩放、模糊、透明
- **托盘**: systray、双击、右键、退出
- **Windows**: DPI、渲染、注册表
- **Go**: sync.Once、atomic、goroutine

### 按严重程度查找

- 🔴 **严重**: 导致功能不可用（如退出无效）
- 🟡 **中等**: 影响用户体验（如图标模糊）
- 🟢 **轻微**: 优化建议（如性能提升）

---

## 📊 统计信息

- **文档总数**: 1
- **最后更新**: 2026-02-05
- **主要技术栈**: Wails, Go, Windows

---

## 🔗 相关资源

### 项目内部文档

- [CLAUDE.md](../../CLAUDE.md) - 项目开发指南
- [docs/fixes/](../fixes/) - 问题修复记录
- [docs/plans/](../plans/) - 项目计划文档

### 外部资源

- [Wails 官方文档](https://wails.io/docs/introduction)
- [Windows API 文档](https://docs.microsoft.com/en-us/windows/win32/api/)

---

**维护说明**: 请保持文档的准确性和时效性，发现问题或改进建议请及时更新。
