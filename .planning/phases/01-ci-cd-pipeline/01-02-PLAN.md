---
phase: 01-ci-cd-pipeline
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - .github/workflows/build.yml
  - docs/config-examples/config.yaml
autonomous: true

must_haves:
  truths:
    - Release package contains executable, README, and config example
    - Package filename follows platform detection naming convention
    - SHA256 and MD5 checksums are generated for the package
    - Config example includes comments explaining each option
  artifacts:
    - path: docs/config-examples/config.yaml
      provides: Annotated configuration example for release package
      contains: all config sections with comments
    - path: build/ai-commit-hub-windows-amd64-v*.zip
      provides: Release package archive
      min_lines: 1
    - path: build/*.sha256
      provides: SHA256 checksum file
      contains: hex digest
    - path: build/*.md5
      provides: MD5 checksum file
      contains: hex digest
  key_links:
    - from: .github/workflows/build.yml (package step)
      to: build/*.zip
      via: 7z compression
      pattern: 7z a.*\.zip
    - from: .github/workflows/build.yml (checksum step)
      to: build/*.{sha256,md5}
      via: sha256sum/md5sum commands
      pattern: sha256sum|md5sum
---

<objective>
Package Windows executable with documentation and generate security checksums for release distribution.

Purpose: Create user-friendly release packages that include the application, documentation, and configuration examples, along with integrity verification checksums.

Output: Properly named ZIP archive with embedded documentation and separate checksum files.
</objective>

<execution_context>
@C:\Users\allan716\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\allan716\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-ci-cd-pipeline/01-CONTEXT.md
@.planning/phases/01-ci-cd-pipeline/01-RESEARCH.md

@.github/workflows/release.yml
@.planning/phases/01-ci-cd-pipeline/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Create config example documentation</name>
  <files>docs/config-examples/config.yaml</files>
  <action>
Create docs/config-examples/config.yaml with a complete, commented configuration example.

The file should include:
1. All configuration sections from the application
2. YAML comments (#) explaining each configuration option
3. Example values that demonstrate proper usage
4. Clear structure that users can copy and modify

Sections should include (based on typical Wails app config):
- AI provider settings (OpenAI, Anthropic, etc.)
- Git project settings
- Notification settings (Pushover, etc.)
- Update settings
- Logging settings

Each major section should have a header comment explaining its purpose.
Each important field should have an inline comment explaining valid values.

Reference the app's actual config structure - grep for config-related code patterns:
- pkg/config/ directory
- Configuration structs in Go code
- Existing config files if any
  </action>
  <verify>
File docs/config-examples/config.yaml exists and:
- Contains multiple sections with # comments
- Has example values for each option
- Is at least 30 lines of documented configuration
  </verify>
  <done>
Users can understand configuration options by reading comments
  </done>
</task>

<task type="auto">
  <name>Add packaging step to workflow</name>
  <files>.github/workflows/build.yml</files>
  <action>
Add "Create release package" step to the workflow after version verification.

The step should:
1. Copy files to build/bin directory:
   - README.md (from repo root)
   - docs/config-examples/config.yaml (rename to config.yaml in package)

2. Create ZIP archive with 7z:
   - Filename: ai-commit-hub-windows-amd64-v{VERSION}.zip
   - Location: build/ directory (not build/bin/)
   - Contents: ai-commit-hub.exe, README.md, config.yaml

3. Naming follows CI-05 requirement:
   ai-commit-hub-windows-{arch}-v{version}.zip

Example shell command:
```bash
cd build/bin
cp ../../../README.md .
cp ../../../docs/config-examples/config.yaml .
7z a "../ai-commit-hub-windows-amd64-v${VERSION}.zip" \
  ai-commit-hub.exe README.md config.yaml
```

Use shell: bash for this step.
  </action>
  <verify>
Workflow contains packaging step that:
- Copies README.md and config.yaml
- Uses 7z to create ZIP
- Outputs to build/ directory
- Names file with ai-commit-hub-windows-amd64-v{version}.zip pattern
  </verify>
  <done>
ZIP package is created with correct naming convention
  </done>
</task>

<task type="auto">
  <name>Add checksum generation step</name>
  <files>.github/workflows/build.yml</files>
  <action>
Add "Generate checksums" step after packaging.

The step should:
1. Navigate to build/ directory (where .zip files are)
2. For each .zip file, generate:
   - SHA256 checksum (using sha256sum)
   - MD5 checksum (using md5sum)
3. Output checksums to workflow log for visibility

Example bash commands:
```bash
cd build
for file in *.zip; do
  sha256sum "$file" > "${file}.sha256"
  md5sum "$file" > "${file}.md5"
done

# Display checksums
echo "::notice::SHA256 Checksums:"
cat *.sha256
echo "::notice::MD5 Checksums:"
cat *.md5
```

Use shell: bash for this step.
  </action>
  <verify>
Workflow contains checksum step that:
- Iterates over .zip files
- Generates both .sha256 and .md5 files
- Outputs checksums to log
  </verify>
  <done>
Checksum files are generated alongside release packages
  </done>
</task>

<task type="auto">
  <name>Add artifact upload for build outputs</name>
  <files>.github/workflows/build.yml</files>
  <action>
Add "Upload artifacts" step to preserve build outputs.

Use actions/upload-artifact@v4 with:
- name: ai-commit-hub-windows-amd64-v{VERSION}
- path: |
    build/*.zip
    build/*.sha256
    build/*.md5
- retention-days: 30

This allows manual download from GitHub Actions UI before release is published.
  </action>
  <verify>
Workflow contains artifact upload step with:
- actions/upload-artifact@v4
- Correct path patterns for .zip, .sha256, .md5 files
- retention-days set
  </verify>
  <done>
Build artifacts are preserved for 30 days
  </done>
</task>

</tasks>

<verification>
After adding packaging steps, verify:

1. Packaging step comes after version verification
2. Files are copied to correct location before zipping
3. ZIP filename follows ai-commit-hub-windows-amd64-v{version}.zip pattern
4. Checksum generation happens after ZIP creation
5. Both SHA256 and MD5 are generated
6. Artifact upload preserves outputs
7. All steps use appropriate shell (bash for cross-platform compatibility)
</verification>

<success_criteria>
1. docs/config-examples/config.yaml exists with documented configuration
2. Workflow creates ZIP package with executable + docs
3. ZIP filename follows platform detection naming convention
4. SHA256 and MD5 checksum files are generated
5. Build artifacts are uploaded to GitHub Actions
6. All steps execute in correct order
</success_criteria>

<output>
After completion, create `.planning/phases/01-ci-cd-pipeline/01-02-SUMMARY.md` with:
- Package contents (exe + README + config)
- Checksum generation approach
- Naming convention rationale
</output>
