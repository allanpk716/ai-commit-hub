# Requirements Archive: v1.0 Foundation & Infrastructure

**Archived:** 2026-02-07
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# AI Commit Hub - Requirements

## Validated

### Core Functionality

- ✓ **AI commit 生成** — v1.0
  - 基于已暂存文件自动生成 commit 消息
  - 支持多个 AI provider（OpenAI、Anthropic、Google Gemini、Ollama）
  - AI Provider 抽象层设计
  - 支持流式和非流式响应

- ✓ **多项目支持** — v1.0
  - 管理多个 Git 仓库
  - 每个项目独立配置
  - 项目列表持久化（SQLite）
  - 项目路径验证

- ✓ **通知功能** — v1.0
  - Pushover 集成
  - Windows 系统通知
  - Pushover cc-pushover-hook 扩展支持

- ✓ **基础 Git 操作** — v1.0
  - commit、push、pull、status 等常用操作
  - Git 命令封装（pkg/git）
  - 错误处理和重试机制

### Infrastructure

- ✓ **CI/CD Pipeline** — v1.0
  - GitHub Actions 自动化构建
  - Wails 构建配置
  - 版本注入（ldflags）
  - 产物打包和校验和生成
  - 自动发布到 GitHub Releases
  - 支持 pre-release 检测

- ✓ **单实例锁定** — v1.0
  - Wails SingleInstanceLock 机制
  - 多实例检测和窗口激活
  - 跨进程通信（Wails Events）

- ✓ **窗口状态管理** — v1.0
  - 窗口位置和大小保存/恢复
  - 最大化状态持久化
  - 窗口边界验证
  - SQLite 存储（GORM）

- ✓ **系统托盘集成** — v1.0
  - 最小化到托盘
  - 双击恢复窗口
  - 右键菜单（显示/隐藏、检查更新、退出）
  - 托盘竞态条件防护

- ✓ **自动更新功能** — v1.0
  - GitHub Releases 版本检测
  - 后台下载更新文件
  - 断点续传支持
  - Wails Events 流式进度显示
  - 外部更新器程序（嵌入主程序）
  - 文件备份和回滚机制
  - 更新完成后自动重启

- ✓ **代码质量** — v1.0
  - 0 编译错误
  - 0 测试失败
  - 重复函数清理
  - 未使用导入清理
  - 日志调用规范化

### User Interface

- ✓ **版本显示** — v1.0
  - 主界面显示当前版本号
  - 关于对话框显示详细版本信息
  - GetVersion() 和 GetFullVersion() API

- ✓ **更新对话框** — v1.0
  - 更新提示对话框
  - 下载进度对话框（实时进度百分比）
  - 安装确认对话框

## Out of Scope

- **复杂 Git 操作** — merge、rebase、cherry-pick 等使用 TortoiseGit
- **完整 Git GUI** — 不替代 TortoiseGit、GitKraken 等专业工具
- **跨平台同步** — 配置文件不跨设备同步
- **团队协作** — 单人开发者工具，无协作功能
- **移动端支持** — Windows 主要平台（macOS/Linux 次要）

## Constraints

- **平台**: Windows 主要平台（macOS/Linux 次要）
- **性能**: 快速启动，低资源占用
- **部署**: 单文件 exe，无需安装
- **更新**: 自动检测并替换更新
- **实例**: 单实例运行
- **兼容性**: 配置文件向后兼容

---

## Milestone Summary

**Shipped:** 12 of 12 v1 requirements ✅
**Adjusted:** 0 requirements
**Dropped:** 0 requirements

### Requirements Delivered

**Core Functionality (4)**
- ✅ AI commit 生成
- ✅ 多项目支持
- ✅ 通知功能
- ✅ 基础 Git 操作

**Infrastructure (6)
- ✅ CI/CD Pipeline
- ✅ 单实例锁定
- ✅ 窗口状态管理
- ✅ 系统托盘集成
- ✅ 自动更新功能
- ✅ 代码质量

**User Interface (2)**
- ✅ 版本显示
- ✅ 更新对话框

### Requirement Outcomes

All requirements validated and working as specified:
- AI commit generation working with multiple providers
- Multi-project management with SQLite persistence
- Pushover and Windows notifications integrated
- Git operations封装完成
- CI/CD fully automated and tested (v0.2.0-beta.1 → v1.0.0)
- Single instance locking working with window activation
- Window state persistence working (position, size, maximized)
- System tray double-click and menu working
- Auto-update system fully functional (version check, download, install, restart)
- All compilation errors fixed (10 logger calls)
- All test failures fixed (2 tests)
- Version display in UI and About dialog
- Update dialogs (3 components) integrated

### Technical Achievements

**Architecture:**
- 分层架构：App → Service → Repository → Database
- 事件驱动：Wails Events 实现前后端通信
- 状态管理：Pinia stores + StatusCache 优化
- 外部更新器：突破 Windows 文件锁定限制

**Performance:**
- 构建时间：10 秒（优化 33%）
- 缓存策略：StatusCache TTL 30 秒
- 并发获取：Git 状态、Pushover 状态并发加载
- 乐观更新：用户操作后立即更新 UI

**Quality Metrics:**
- 编译通过率：100% ✅
- 测试通过率：100% ✅
- 代码覆盖率：核心功能全覆盖
- LOC：7,115 (Go + Vue + TypeScript)

---
*Archived: 2026-02-07 as part of v1.0 milestone completion*
